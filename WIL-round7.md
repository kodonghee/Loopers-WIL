# WIL - 7주차 (Decoupling with Event)

## 🧠 이번 주에 새로 배운 것
- ApplicationEventPublisher
- 트랜잭션 분리 & 도메인 decoupling
- 후속 처리 비동기화
- 사후 정합성 처리 전략

## 💭 이런 고민이 있었어요
1. 이벤트 핸들러 어노테이션 전략
- @EventListener, @TransactionalEventListener
- BEFORE_COMMIT, AFTER_COMMIT, AFTER_ROLLBACK, AFTER_COMPLETION
- 어떤 경우에 어떤 전략을 써야하는지 판단하는 것에 대한 고민
2. 핸들러에서 로직을 꼭 제외 해야 하나?
- 이벤트 핸들러의 역할에 집중해 보면 로직이 있는 건 알맞지 않음
- 서비스 함수를 호출하는 것이 좋음
3. 결제 실패 시 정상 응답 vs 롤백 되는 상황
- 두 경우 모두 소스에 존재함 ➡️ 결제 실패 시 행동을 통일할 수도 있고 두 경우 이벤트를 분리할 수도 있음
- 어떤 것이 더 나은지에 대한 고민 해봐야 함
4. 롤백을 트리거 삼는 경우가 알맞을까?
- 결제 실패 시 롤백되는 경우 이벤트 발행을 하게 되어 AFTER_ROLLBACK을 사용함 ..
- 롤백을 트리거 삼는 것은 위험하고 유실 가능성이 있을 수 있음, 롤백이 끝난 뒤의 이벤트만 받는 것이기 때문에 이때 주문 상태 변경이 실패하게 되면 유실될 것 같음
- 이 부분 더 고민해 볼 필요 있음

## 💡 앞으로 실무에 써먹을 수 있을 것 같은 포인트
- 외부 시스템 연동 시 이벤트 발행 전략을 활용하여 개발하면 정말 중요한 핵심 로직과 부가 로직을 분리할 수 있을 것 같다.

## 🤔 아쉬웠던 점 & 다음 주에 해보고 싶은 것
- 이벤트 전략을 달리하여 여러 번 테스트 하지 못한 것 아쉽다.
- 이벤트 .. 확장하여 Kafka 활용하기
