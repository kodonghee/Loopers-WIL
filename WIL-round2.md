# WIL - 2주차 (소프트웨어 설계)

## 🧠 이번 주에 새로 배운 것
- 설계의 중요성
  - 설계는 **소통의 도구** (기획자, 프론트엔드, 백엔드, 수행사 등)
  - 설계는 운동 전 스트레칭 같이 구현 전 수행하면 많이 도움이 되는 것
  - 설계는 맞고 틀림 판단이 어려움
- 설계 문서 종류
  - 요구사항 명세서
    - 기능적 요구사항: 시스템이 "무엇을" 해야 하는지
    - 비기능적 요구사항: 시스템이 "어떻게" 해야 하는지
    - 확장성 있는 설계 고려할 때 주의
  - 시퀀스 다이어그램: API 단위로 작성, 구현 흐름(How), 각 개별 시나리오에 대한 버드뷰이자 전체 시나리오에 대해서는 트리뷰
  - 클래스 다이어그램: 클래스가 뭘 알고 있는지, 뭘 할 수 있는지, 책임과 소통, 행동, 어떤 클래스와 연관이 있는가 표현한 도식
    - VO로 격상시킬 필드는 VO로서 가치를 가지고 있는지 꼭 판단해야 한다.
  - ERD
  - 상태 다이어그램
  - Flow 차트

## 💭 이런 고민이 있었어요
1. 요구사항 명세 - 어디까지 자세하게, 어떤 관점에 대해서 적어야 할지 고민이 많았다.
   - 멘토링 이후 개발자가 아닌 사람들도 뭘 하고 싶은지 명확하게 알아야 하는 것이 요구사항 명세이고 소통의 도구라는 말을 듣고 적당히 자세하게 작성하려고 노력했다.
   - 개발자 관점의 용어는 최대한 줄여서 작성함
   - 각 시나리오 실패 시 오류 유형을 적기보다는 사용자가 마주칠 안내 메세지를 작성함
   - 조회했을 때 나오는 상세 필드를 구체적으로 작성하지는 않음 -> 대략 이해가 되게끔 전달할 수 있느냐에 초점을 맞춤
2. 좋아요 등록/취소 시퀀스 다이어그램을 나눠야할지, 말아야할지 고민
   - 둘다 하나의 시퀀스로 그려내기에는 복잡하여 API 단위로 그리기로 결정
   - 둘이 다른 api이므로 .. 같은 버튼을 눌렀을 때 좋아요 등록을 할 건지 취소할 건지는 프론트단에서 분기처리해야 한다고 생각함. 프론트에서 이미 좋아요 표시가 되어있으므로 좋아요 유무 정보를 가지고 있을 것임
   - 하지만 멱등성을 유지하려면 좋아요 체크 로직이 백 단에도 있어야 할 것 같음. 복잡해서 시퀀스 다이어그램에는 넣지 않음
   - 그리고 체크한다고 해도 그에 대한 오류 메세지를 반환하지 않고 무시할 것이기 때문에 일단 시퀀스 다이어그램에는 생략함
   - 멱등성 때문에 내부적으로 체크는 해도 동작 흐름을 바꾸지는 않음, 외부에서 보이는 응답은 항상 동일함
3. 로그인을 아예 안한 경우랑 사용자가 없을 경우를 둘 다 고려하기로 함
   - 처음에는 미로그인만 적으려고 했음. 미로그인이면 유저 서비스에서 확인할 필요도 없고 컨트롤러 단에서 바로 로그인하라고 응답하면 될 줄 알았는데
   - 로그인을 했어도 잘못된 사용자일 수도 있는 가능성이 있으니까 (시스템을 완전히 믿으면 안됨) 좋아요 관련 데이터가 정합성이 떨어지게 되므로 꼭 검증해야 함
4. 재고 테이블은 따로 만들어야 할듯. 상품 마스터와 별개
   - 상품 정보보다 재고 테이블은 변동이 잦은데 그때마다 상품 정보 모두 들어있는 테이블 조회하는 것이 비효율적 —> 하지만 지금 구조에서는 불필요함
5. 시퀀스 다이어그램 완전 고수준에서 작성
   - 현재 service, facade 수준까지 고려하기에는 부족(내 실력이...)하다고 판단하여 완전 기획자 마인드로 가져감
   - 명확한 표현을 위해 생명선 추가
   - 로그인 여부는 생략 (당연히 되어있다고 생각하고 작성)
   - 모두 한글로 이해가 되게끔 작성
6. 도메인 객체 설계
   - user안에 Like객체 리스트, Order객체 리스트 넣으려고 했으나 유저 정보만 필요한 경우에도 다른 데이터 불러올 수 있고 객체가 너무 커짐 방지하기 위해 안 넣음
   - user에 연관 필드 포함 안하고 각 도메인에서 유저를 참조하도록 함
7. ERD 에서 point랑 stock에 대한 테이블을 따로 만들지 않음

## 💡 앞으로 실무에 써먹을 수 있을 것 같은 포인트
- mermaid라는 아주 좋은 도구를 알게 되었다. 회사에서 시스템 구조도나 플로우 차트를 그리는 경우가 많은데 동료들에게 소개해야겠다.
- 설계 문서는 인수인계할 때 편리하라고 작성하는 것도 있지만 중요한 용도는 "소통"이므로 기획자 관점에서 작성하도록 노력해야겠다.

## 🤔 아쉬웠던 점 & 다음 주에 해보고 싶은 것
- 일단 계층 개념을 잘 몰라서 시퀀스 다이어그램을 고수준으로 작성할 수 밖에 없었다. (불행인지 다행인지)
- 구현이 시작되어도 요구사항이 변경될 때마다 설계 문서를 업데이트 해야겠다.
