# WIL - 9주차 (What is Popularity?)

## 🧠 이번 주에 새로 배운 것
- Redis Sorted Set (ZSET)
- ZINCRBY 기반 실시간 집계
- Top-N API
- 일별 Key 전략 & TTL
- 콜드 스타트 문제

## 💭 이런 고민이 있었어요
1. 최적의 랭킹 점수 계산하기
- 인기도 = 곧 랭킹인데 가중치 계산에 포함시킬 지표들이 어떤 게 있을까?
- 주문 시도 수, 좋아요, 찜, 장바구니 넣기, 클릭 수 등 지표가 더 많아지면 더 정확하고 도움이 되는 랭킹을 만들 수 있을 것 같음
2. 카프카 발행/컨슘 시 토픽 이슈
- 각 지표 발행 시 토픽을 다르게 설정하면 같은 productId에 대해 경합이 생길 수 있나?
- 레디스 ZINCRBY는 원자 연산이라 실제 점수는 안전하게 합산됨
- 순서가 뒤바뀔 수 있으나 랭킹 점수는 누적치라서 순서가 달라도 상관 없음
3. 콜드 스타트
- 일별 랭킹의 경우 날짜가 바뀔 때 .. 누적 지표들이 없으므로 랭킹이 이상하게 보일 수 있음
- 새로 등록된 상품에 기본 점수 부여하는 방식이 있을 수 있음
- 신상품은 다른 상품들보다 고객 지표가 없을 수밖에 없기 때문에 시간대비 지표를 계산하는 로직이 있으며 좋을 것 같음

## 💡 앞으로 실무에 써먹을 수 있을 것 같은 포인트
- 조회량이 많은 집계 정보는 레디스를 사용하되, DB에도 영속화 하여 장애 대비를 할 수 있을 것 같다.
- 정렬이 필요한 경우 레디스의 ZINCRBY를 활용할 수 있을 것 같다.

## 🤔 아쉬웠던 점 & 다음 주에 해보고 싶은 것
- 콜드 스타트를 해결하지 못해서 이 부분을 보완해서 주간/월간 랭킹을 만들어 보고 싶다.
- 지표를 더 추가해보고 싶다. (현재는 좋아요랑 주문 수만 존재함)
